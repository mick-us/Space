<!Doctype html>
<html>
    <head>
        <title>Space</title>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
    </head>
    <body>
        <script type"text/javascript" src="dat.gui.min.js"></script>

        <script type="x-shader/x-vertex" id="fragmentShader">
            void main() 
            {
                gl_FragColor = vec4(gl_FragCoord.x*0.0005,0.,0.,1.);
            }
        </script>

        <script type="x-shader/x-vertex" id="fragmentShader2">
            uniform vec3 color;
            void main() 
            {
              gl_FragColor = vec4(gl_FragCoord.xy*0.001,0.5,1.0);
            }
        </script>

        <script type="module">
            import * as THREE from 'https://unpkg.com/three@0.121.1/build/three.module.js';
		    import { OrbitControls } from 'https://unpkg.com/three@0.121.1/examples/jsm/controls/OrbitControls.js';
            import { OBJLoader } from 'https://unpkg.com/three@0.121.1/examples/jsm/loaders/OBJLoader.js';
            
            //declaration des variables globales
            var renderer, scene, camera, controls;
            var mercure, g_mercure;
            var jupiter, g_jupiter;
            var saturne, g_saturne;
            var moon, pivot_moon;

            init()
            animate()

            function init()
            {
                //render
                renderer = new THREE.WebGLRenderer({ antialias: true });
		        renderer.setPixelRatio(window.devicePixelRatio);
		        renderer.setSize(window.innerWidth, window.innerHeight);
	            document.body.appendChild(renderer.domElement);
                renderer.setClearColor(0x000000, 1.0);
                renderer.clear();

                //scene
                scene = new THREE.Scene(); 
                scene.background = new THREE.TextureLoader().load( "ciel-etoile.JPG" );

                //camera
                camera = new THREE.PerspectiveCamera(100,window.innerWidth/window.innerHeight,0.1,1500);
                camera.lookAt(scene.position);
                camera.position.set(0,400,500);
                camera.rotation.set(0,0,0);

                //groupe
                g_mercure=new THREE.Group();
                scene.add(g_mercure);

                g_saturne=new THREE.Group();
                scene.add(g_saturne);

                g_jupiter=new THREE.Group();
                scene.add(g_jupiter);

                //Pivot
                pivot_moon=new THREE.Object3D();
                g_jupiter.add(pivot_moon);

                //lumiere
                var Light= new THREE.HemisphereLight(0xfff1bb,0xfff1bb,1);
                Light.position.set(0,800,0);
                scene.add(Light);

                //controls
                controls=new OrbitControls(camera,renderer.domElement);

                //Soleil
                var texture_soleil= new THREE.TextureLoader().load( "texture_soleil.JPG" );
                var sun=new THREE.Mesh(new THREE.SphereGeometry(100,100,100),new THREE.MeshBasicMaterial({map:texture_soleil }));
                sun.position.set(0,0,0);
                g_saturne.add(sun);
                g_mercure.add(sun);
                g_jupiter.add(sun);

                //Mercure
                mercure=new THREE.Mesh(new THREE.SphereGeometry(30,30,30),new THREE.ShaderMaterial({
                    fragmentShader: document.getElementById( 'fragmentShader' ).textContent}));
                mercure.position.set(200,0,0);
                g_mercure.add(mercure);

                //Saturne
                var texture_saturne = new THREE.TextureLoader().load( "texture_saturne.jpg" );
                saturne=new THREE.Mesh(new THREE.SphereGeometry(40,40,40),new THREE.MeshBasicMaterial({map:texture_saturne}));
                saturne.position.set(-400,0,0);
                g_saturne.add(saturne);

                //Jupiter
                var texture_jupiter = new THREE.TextureLoader().load( "texture_jupiter.JPG" );
                jupiter=new THREE.Mesh(new THREE.SphereGeometry(35,35,35),new THREE.MeshBasicMaterial({map:texture_jupiter}));
                jupiter.position.set(600,0,0);
                g_jupiter.add(jupiter);
                
                //Lune 
                moon=new THREE.Mesh(new THREE.SphereGeometry(15,15,15),new THREE.MeshPhongMaterial({color:0xFFFFFF}));
                moon.position.set(-75,0,0);
                pivot_moon.add(moon);
                
                //repere xyz
                var axisHelper=new THREE.AxesHelper(500);
                scene.add(axisHelper);
            }

            function animate()
            {
                jupiter.rotation.y+=0.01;
                saturne.rotation.y-=0.01;
                mercure.rotation.y+=0.015;
                pivot_moon.position.set(jupiter.position.x,jupiter.position.y,jupiter.position.z);
                pivot_moon.rotation.y+=0.008;
                g_saturne.rotation.y+=0.0005;
                g_jupiter.rotation.y+=0.001;
                g_mercure.rotation.y+=0.005;
                requestAnimationFrame(animate);
                renderer.render(scene,camera); //rendu avec la scene et la camera
                controls.update();
            }

            function print(message) 
            {
                console.log(message);
            }
        </script>
    </body>
</html>

